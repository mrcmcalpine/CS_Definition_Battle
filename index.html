<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Word Guess Challenge</title>
  <style>
    body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #6a11cb, #2575fc); color: #fff; text-align: center; padding: 20px; min-height: 100vh; display: flex; flex-direction: column; align-items: center; }
    h1 { font-size: 2.5rem; margin-bottom: 20px; }
    #clueBox, #wordBox, #livesBox, #scoreBox, #feedback, #incorrectWordsBox { margin: 10px 0; font-size: 1.2rem; }
    #clueBox { text-align: left; max-width: 500px; }
    .clue { opacity: 0; transform: translateY(10px); animation: fadeIn 0.6s ease forwards; margin: 5px 0; padding: 8px 12px; background: rgba(255,255,255,0.15); border-radius: 8px; }
    @keyframes fadeIn { to { opacity:1; transform:translateY(0); } }
    #wordBox { font-size: 2rem; letter-spacing: 8px; font-weight: bold; }
    input[type=text] { padding: 10px; font-size:1.2rem; border-radius:8px; border:none; outline:none; width:250px; text-align:center; }
    button { padding:10px 20px; font-size:1rem; border:none; border-radius:25px; margin:5px; cursor:pointer; background:#fff; color:#2575fc; font-weight:bold; transition:0.2s; }
    button:hover { background:#f0f0f0; transform:scale(1.05); }
    #leaderboard { margin-top:30px; background:rgba(255,255,255,0.1); padding:20px; border-radius:15px; width:300px; }
    #leaderboard h2 { margin-bottom:15px; }
    #leaderboardList { list-style:none; padding:0; text-align:left; }
    #leaderboardList li { margin:5px 0; font-size:1.1rem; }
    #feedback { font-size:1.3rem; font-weight:bold; }
    #incorrectWordsBox { text-align:left; max-width:500px; }
  </style>
</head>
<body>
<h1>Word Guess Challenge üéØ</h1>
<div id="namePrompt">
  Enter your name: <input type="text" id="playerNameInput" placeholder="Your name">
  <button id="submitNameBtn">Submit</button>
</div>
<div id="gameUI" style="display:none;">
  <div id="clueBox">Press Start to begin!</div>
  <div id="wordBox"></div>
  <div id="livesBox">Lives: 5</div>
  <input type="text" id="guessInput" placeholder="Type your guess here..." disabled>
  <button id="submitBtn" disabled>Submit</button>
  <button id="startBtn">Start Game</button>
  <button id="playAgainBtn" style="display:none;">Play Again</button>
  <div id="feedback"></div>
  <div id="scoreBox">Score: 0</div>
  <div id="incorrectWordsBox"></div>
  <div id="leaderboard">
    <h2>Leaderboard üèÜ</h2>
    <ul id="leaderboardList"></ul>
  </div>
</div>
<script>
let words = [];
let currentWord, clueIndex=0, score=0, lives=5, revealedLetters=[], gameStarted=false;
let playerName='';
let incorrectWords=[];

const namePrompt = document.getElementById('namePrompt');
const playerNameInput = document.getElementById('playerNameInput');
const submitNameBtn = document.getElementById('submitNameBtn');
const gameUI = document.getElementById('gameUI');
const clueBox = document.getElementById("clueBox");
const wordBox = document.getElementById("wordBox");
const livesBox = document.getElementById("livesBox");
const guessInput = document.getElementById("guessInput");
const submitBtn = document.getElementById("submitBtn");
const startBtn = document.getElementById("startBtn");
const playAgainBtn = document.getElementById("playAgainBtn");
const scoreBox = document.getElementById("scoreBox");
const feedback = document.getElementById("feedback");
const leaderboardList = document.getElementById("leaderboardList");
const incorrectWordsBox = document.getElementById("incorrectWordsBox");

// Load words from external JSON
async function loadWords(){
  try{
    const response = await fetch('./words.json');
    if(!response.ok) throw new Error('Could not load words.json');
    words = await response.json();
  }catch(e){
    clueBox.textContent='Error loading words.json.';
    console.error(e);
  }
}

function pickWord(){
  currentWord = words[Math.floor(Math.random()*words.length)];
  clueIndex=0;
  revealedLetters=Array(currentWord.answer.length).fill(false);
  displayWordProgress();
  showClues();
  feedback.textContent='';
  guessInput.value='';
  guessInput.maxLength = currentWord.answer.length;
}

function showClues(){
  clueBox.innerHTML='';
  for(let i=0;i<=clueIndex;i++){
    if(currentWord.clues[i]){
      const d=document.createElement('div');
      d.className='clue';
      d.textContent=`Clue ${i+1}: ${currentWord.clues[i]}`;
      clueBox.appendChild(d);
    }
  }
}

function displayWordProgress(){
  let display='';
  for(let i=0;i<currentWord.answer.length;i++){
    display += revealedLetters[i]?currentWord.answer[i]+' ':'_ ';
  }
  wordBox.textContent=display.trim();
}

function revealRandomLetter(){
  const unrevealed=[];
  for(let i=0;i<currentWord.answer.length;i++) if(!revealedLetters[i]) unrevealed.push(i);
  if(unrevealed.length>0){
    const idx=unrevealed[Math.floor(Math.random()*unrevealed.length)];
    revealedLetters[idx]=true;
    displayWordProgress();
  }
}

function checkGuess(){
  if(!gameStarted) return;
  const guess=guessInput.value.trim().toLowerCase();
  if(!guess) return;
  if(guess===currentWord.answer.toLowerCase()){
    score += 5-clueIndex*2>0?5-clueIndex*2:0;
    scoreBox.textContent=`Score: ${score}`;
    feedback.textContent='‚úÖ Correct!';
    pickWord();
  }else{
    clueIndex++;
    lives--;
    livesBox.textContent=`Lives: ${lives}`;
    revealRandomLetter();
    showClues();
    feedback.textContent='‚ùå Wrong!';
    if(!incorrectWords.includes(currentWord.answer)) incorrectWords.push(currentWord.answer);
    displayIncorrectWords();
    if(lives<=0){
      feedback.textContent=`üíÄ Game Over! Word was: ${currentWord.answer}`;
      guessInput.disabled=true;
      submitBtn.disabled=true;
      playAgainBtn.style.display='inline-block';
      gameStarted=false;
      saveLocalLeaderboard();
    }
  }
  guessInput.value='';
}

function displayIncorrectWords(){
  if(incorrectWords.length===0){
    incorrectWordsBox.textContent='';
    return;
  }
  incorrectWordsBox.innerHTML='<strong>Incorrect Words:</strong> '+incorrectWords.join(', ');
}

function saveLocalLeaderboard(){
  let leaderboard=JSON.parse(localStorage.getItem('leaderboard')||'[]');
  leaderboard.push({name:playerName, score:score, timestamp:new Date().toISOString()});
  leaderboard.sort((a,b)=>b.score-a.score);
  leaderboard=leaderboard.slice(0,10);
  localStorage.setItem('leaderboard', JSON.stringify(leaderboard));
  displayLocalLeaderboard();
}

function displayLocalLeaderboard(){
  let leaderboard=JSON.parse(localStorage.getItem('leaderboard')||'[]');
  leaderboardList.innerHTML='';
  leaderboard.forEach((entry,i)=>{
    const li=document.createElement('li');
    li.textContent=`${i+1}. ${entry.name} - ${entry.score}`;
    leaderboardList.appendChild(li);
  });
}

submitNameBtn.addEventListener('click',async ()=>{
  const name=playerNameInput.value.trim();
  if(!name){alert('Enter a name'); return;}
  playerName=name;
  namePrompt.style.display='none';
  gameUI.style.display='block';
  score=0;lives=5;incorrectWords=[];
  scoreBox.textContent=`Score: ${score}`;
  livesBox.textContent=`Lives: ${lives}`;
  guessInput.disabled=false;
  submitBtn.disabled=false;
  gameStarted=true;
  await loadWords();
  pickWord();
  displayLocalLeaderboard();
});

submitBtn.addEventListener('click',checkGuess);
guessInput.addEventListener('keyup',e=>{if(e.key==='Enter') checkGuess();});
startBtn.addEventListener('click',()=>{score=0;lives=5;incorrectWords=[];scoreBox.textContent=`Score: ${score}`;livesBox.textContent=`Lives: ${lives}`;guessInput.disabled=false;submitBtn.disabled=false;playAgainBtn.style.display='none';gameStarted=true;pickWord();displayIncorrectWords();});
playAgainBtn.addEventListener('click',()=>{score=0;lives=5;incorrectWords=[];scoreBox.textContent=`Score: ${score}`;livesBox.textContent=`Lives: ${lives}`;guessInput.disabled=false;submitBtn.disabled=false;playAgainBtn.style.display='none';gameStarted=true;pickWord();displayIncorrectWords();});
</script>
</body>
</html>
